!function(){var e={initialize:function(){console.log("Инициализация приложения"),this.setUpListeners()},setUpListeners:function(){console.log("Прослушка событий вклбчена"),$(".add-new-item").on("click",e.showModal),$(".b-close, #overlay").on("click",e.closeModal),$("#contact-me").on("submit",e.contactMe)},showModal:function(){console.log("Вызов модального окна"),$("#overlay").fadeIn(400,function(){$("#modal").css("display","block").animate({opacity:1,top:"50%"},200)});var e=$(".fileupload-wrapper"),t=e.find("input"),o=e.find("button"),n=e.find("div");o.focus(function(){t.focus()}),t.focus(function(){e.addClass("focus")}).blur(function(){e.removeClass("focus")});var i=window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1;t.change(function(){var e;e=i&&t[0].files[0]?t[0].files[0].name:t.val().replace("C:\\fakepath\\",""),e.length&&(n.is(":visible")?n.text(e):o.text(e))}).change()},closeModal:function(){console.log("Закрытие модального окна"),$("#modal").animate({opacity:0,top:"50%"},200,function(){$(this).css("display","none"),$("#overlay").fadeOut(400)})},validateForm:function(t){console.log("Проверяем форму");var o=t.find("input, textarea").not('input[type="file"], input[type="hidden"]'),n=!0;return $.each(o,function(t,o){var i=$(o),o=i.val(),a=i.attr("qtip-position");0==o.length&&(i.addClass("has-error"),e.createQtip(i,a),n=!1)}),n},createQtip:function(e,t){console.log("Создаем тултип"),t="right"===t?{my:"left center",at:"right center"}:{my:"right center",at:"left center",adjust:{method:"shift none"}},e.qtip({content:{text:function(){return $(this).attr("qtip-content")}},show:{event:"show"},hide:{event:"keydown hideTooltip"},position:t,style:{classes:"qtip-mystyle qtip-rounded",tip:{height:10,width:16}}}).trigger("show")},ajaxForm:function(t,o){if(!e.validateForm(t))return!1;var n=t.serialize();return $.ajax({type:"POST",url:o,dataType:"JSON",data:n}).fail(function(){console.log("Проблемы в PHP"),t.find(".error-mes").text("На серевере произошла ошибка").show()})},contactMe:function(t){console.log("Работаем с формой связи"),t.preventDefault();var o=$(this),n="./app/send_mail.php",i=e.ajaxForm(o,n);i&&i.done(function(e){var t=e.mes,n=e.status;"OK"===n?(o.trigger("reset"),o.find("success-mes").text(t).show()):o.find("error-mes").text(t).show()})},clearForm:function(e){console.log("Очищаем форму");var e=$(this);e.find(".input, .textarea").trigger("hideTooltip"),e.find(".has-error").removeClass("has-error"),e.find(".error-mes, success-mes").text("").hide()}};e.initialize()}();